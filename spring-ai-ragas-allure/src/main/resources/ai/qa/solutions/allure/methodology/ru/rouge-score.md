# Метрика ROUGE Score

## Глоссарий

- **ROUGE** — Recall-Oriented Understudy for Gisting Evaluation
- **ROUGE-1** — перекрытие униграмм (отдельных слов)
- **ROUGE-2** — перекрытие биграмм (двух последовательных слов)
- **ROUGE-L** — перекрытие по наибольшей общей подпоследовательности (LCS)
- **Точность (Precision)** — сколько из ответа совпадает с эталоном
- **Полнота (Recall)** — сколько из эталона покрыто ответом
- **F-мера** — гармоническое среднее точности и полноты

## Описание

ROUGE (Recall-Oriented Understudy for Gisting Evaluation) — набор метрик для оценки схожести текстов путём измерения перекрытия между текстом-кандидатом и эталонным текстом. Изначально разработана для оценки автоматического реферирования, но широко используется для различных задач генерации текста.

Особенности метрики:
- **Без LLM** — не требует вызовов языковых моделей
- **Настраиваемая** — поддерживает разные типы перекрытия (ROUGE-1, ROUGE-2, ROUGE-L)
- **Ориентирована на полноту** — измеряет, какая часть эталона покрыта
- **Детерминированная** — одинаковые входные данные всегда дают одинаковый результат

## Пример

**Эталон:** "Быстрая коричневая лиса прыгает через ленивую собаку."

**Ответ AI:** "Быстрая коричневая лиса прыгает через ленивую собаку."

**ROUGE-L Скор:** идентичные тексты = **1.00 (100%)**

---

**Частичное совпадение:**

**Ответ AI:** "Быстрая коричневая лиса бежит."

**ROUGE-L Скор:** частичное совпадение последовательности = **0.55 (55%)**

---

**Изменённый порядок:**

**Ответ AI:** "Через ленивую собаку прыгает быстрая коричневая лиса."

**ROUGE-1 Скор:** высокое перекрытие слов = **0.89 (89%)**
**ROUGE-L Скор:** меньшая LCS = **0.56 (56%)**

## Интерпретация скора

|  Скор   |          Значение          |
|---------|----------------------------|
| 90-100% | Почти полное перекрытие    |
| 70-90%  | Высокое перекрытие         |
| 50-70%  | Умеренное перекрытие       |
| 30-50%  | Некоторое перекрытие       |
| 0-30%   | Практически нет перекрытия |

## Важные замечания

- **ROUGE-1 vs ROUGE-L**: ROUGE-1 игнорирует порядок слов, ROUGE-L учитывает последовательность
- **Точность vs Полнота**: Короткие ответы имеют высокую точность, но низкую полноту; длинные — наоборот
- **F-мера балансирует оба**: Обычно лучший единичный показатель для отчётности
- **Не семантическая**: Как и BLEU, измеряет поверхностное перекрытие, а не смысл

## Алгоритм

### ROUGE-1 / ROUGE-2

1. **Токенизация** — разбиение обоих текстов на токены
2. **Извлечение N-грамм** — сбор униграмм (ROUGE-1) или биграмм (ROUGE-2)
3. **Подсчёт совпадений** — подсчёт перекрывающихся n-грамм
4. **Вычисление скоров** — расчёт точности, полноты и F-меры

### ROUGE-L

1. **Токенизация** — разбиение обоих текстов на токены
2. **Поиск LCS** — вычисление наибольшей общей подпоследовательности
3. **Вычисление скоров** — precision = LCS/длина_ответа, recall = LCS/длина_эталона

## Формула

**Точность:**

```
P = |совпадающие_n-граммы| / |n-граммы_ответа|
```

**Полнота:**

```
R = |совпадающие_n-граммы| / |n-граммы_эталона|
```

**F-мера:**

```
F1 = 2 × (P × R) / (P + R)
```

## Конфигурация

| Параметр  | Тип  | По умолчанию |                  Описание                   |
|-----------|------|--------------|---------------------------------------------|
| rougeType | Enum | ROUGE_L      | Тип ROUGE: ROUGE_1, ROUGE_2, ROUGE_L        |
| mode      | Enum | FMEASURE     | Режим скоринга: PRECISION, RECALL, FMEASURE |

## Ссылки

- [Статья о ROUGE (Lin, 2004)](https://aclanthology.org/W04-1013.pdf)
- [ROUGE Wikipedia](https://en.wikipedia.org/wiki/ROUGE_(metric))

