# Метрика Rubrics Score (Оценка по рубрикам)

## Глоссарий

- **Рубрика** — шкала оценки с несколькими уровнями и чёткими критериями для каждого
- **Уровень рубрики** — одна из оценок на шкале (например, 5 = Отлично, 4 = Хорошо)
- **Нормализация** — приведение уровня к шкале от 0 до 1
- **Агентная система** — система на основе LLM, генерирующая ответы

## Описание

Метрика оценивает ответ агентной системы по заданной рубрике с несколькими уровнями. Каждый уровень имеет чёткое описание критериев соответствия. LLM анализирует ответ и выбирает наиболее подходящий уровень. Результат нормализуется к шкале от 0.0 до 1.0.

## Пример

**Рубрика (5-балльная шкала):**

| Уровень |     Название      |                        Критерии                        |
|---------|-------------------|--------------------------------------------------------|
| 5       | Отлично           | Полный, точный, хорошо структурированный, с примерами  |
| 4       | Хорошо            | Точный с незначительными упущениями, хорошая структура |
| 3       | Удовлетворительно | Охватывает основное, но без глубины                    |
| 2       | Плохо             | Значительные пробелы или неточности                    |
| 1       | Очень плохо       | В основном неверный или нерелевантный                  |

**Ответ агентной системы:** «Эйфелева башня была построена в 1889 году для Всемирной выставки. Её высота 330 метров, и спроектировал её Гюстав Эйфель.»

**Анализ:**
- Точная информация ✓
- Охватывает несколько аспектов ✓
- Хорошая структура ✓
- Не хватает глубины (нет примеров, нет исторического контекста)

**Выбранный уровень:** 4 (Хорошо)

**Скор:** (4-1)/(5-1) = **0.75 (75%)**

## Интерпретация скора

Скор нормализуется на основе шкалы рубрики:

| Уровень (из 5) |    Скор     |     Значение      |
|----------------|-------------|-------------------|
| 5              | 1.00 (100%) | Отлично           |
| 4              | 0.75 (75%)  | Хорошо            |
| 3              | 0.50 (50%)  | Удовлетворительно |
| 2              | 0.25 (25%)  | Плохо             |
| 1              | 0.00 (0%)   | Очень плохо       |

## Алгоритм

1. **Определение рубрики** — задаются уровни с чёткими описаниями критериев
2. **Анализ** — LLM анализирует ответ и сравнивает с каждым уровнем
3. **Выбор уровня** — LLM выбирает наиболее подходящий уровень
4. **Нормализация** — уровень преобразуется в скор от 0 до 1

## Формула

```
score = (selected_level - min_level) / (max_level - min_level)
```

Где:
- `selected_level` — уровень рубрики, выбранный LLM
- `min_level` — минимальный уровень в рубрике (обычно 1)
- `max_level` — максимальный уровень в рубрике (обычно 5)

## Ссылки

- [Документация RAGAS](https://github.com/vibrantlabsai/ragas/blob/main/docs/concepts/metrics/available_metrics/general_purpose.md)

