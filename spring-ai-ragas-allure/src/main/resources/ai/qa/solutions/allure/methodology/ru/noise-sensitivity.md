# Метрика Noise Sensitivity (Чувствительность к шуму)

## Глоссарий

- **Шум** — нерелевантные контексты, не относящиеся к вопросу пользователя
- **Reference (эталон)** — ожидаемый правильный ответ на вопрос пользователя
- **Контекст** — фрагменты информации, предоставленные агентной системе
- **Агентная система** — система на основе LLM, генерирующая ответы

## Описание

Метрика оценивает устойчивость агентной системы к нерелевантной информации (шуму) в контексте. Проверяет, не использовала ли система шумовые контексты при формировании ответа. Низкий скор означает высокую устойчивость — агентная система успешно игнорирует нерелевантную информацию.

**Особенность:** Это обратная метрика — чем ниже скор, тем лучше.

## Пример

**Вопрос пользователя:** «Когда была построена Эйфелева башня?»

**Reference (эталон):** «Эйфелева башня была построена в 1889 году.»

**Контексты:**
1. «Эйфелева башня была завершена в 1889 году.» (релевантно)
2. «Погода в Париже весной мягкая.» (шум)
3. «В башне 1665 ступеней.» (шум)

**Ответ агентной системы:** «Эйфелева башня была построена в 1889 году. В Париже весной мягкая погода.»

**Анализ:**
- Факт о 1889 годе — из релевантного контекста ✓
- Факт о погоде — из шумового контекста ✗

**Скор:** > 0% (использован шум — плохо)

Если бы ответ содержал только факт о 1889 годе, скор был бы **0% (хорошо)**.

## Интерпретация скора

|  Скор   |                           Значение                           |
|---------|--------------------------------------------------------------|
| 0-10%   | Агентная система успешно игнорирует шум                      |
| 10-30%  | Агентная система в основном устойчива к шуму                 |
| 30-50%  | Агентная система иногда использует шумовую информацию        |
| 50-100% | Агентная система подвержена влиянию нерелевантных контекстов |

## Алгоритм

1. **Разбиение на утверждения** — эталон и ответ разбиваются на атомарные утверждения
2. **Сравнение с эталоном** — проверяется соответствие утверждений ответа эталону
3. **Анализ источников** — определяется, из каких контекстов пришли утверждения
4. **Расчёт скора** — оценивается доля шумовой информации в ответе

## Режимы работы

- **RELEVANT** — измеряет ошибки от релевантных контекстов
- **IRRELEVANT** — измеряет ошибки от нерелевантных (шумовых) контекстов

## Формула

```
score = noise_statements / total_statements
```

Где:
- `noise_statements` — количество утверждений в ответе, взятых из шумовых контекстов
- `total_statements` — общее количество утверждений в ответе

## Ссылки

- [Документация RAGAS](https://github.com/vibrantlabsai/ragas/blob/main/docs/concepts/metrics/available_metrics/noise_sensitivity.md)

