# Метрика String Similarity

## Глоссарий

- **Редакционное расстояние** — минимальное количество операций для преобразования одной строки в другую
- **Расстояние Левенштейна** — редакционное расстояние с операциями вставки, удаления, замены
- **Расстояние Хэмминга** — количество позиций, где символы различаются (строки одинаковой длины)
- **Сходство Джаро** — сходство на основе совпадающих символов и транспозиций
- **Джаро-Винклер** — Джаро с бонусом за совпадающий префикс

## Описание

Метрики строкового сходства измеряют, насколько похожи две строки, используя различные алгоритмы редакционного расстояния. Эти метрики полезны для сценариев точного или почти точного сопоставления:

- **Сопоставление сущностей** — сравнение имён, идентификаторов
- **Обнаружение опечаток** — поиск орфографических ошибок
- **Оценка кратких ответов** — сравнение кратких фактических ответов
- **Дедупликация** — поиск похожих строк в наборах данных

Особенности метрики:
- **Без LLM** — не требует вызовов языковых моделей
- **Быстрая** — простые строковые операции
- **Настраиваемая** — доступно несколько алгоритмов
- **Детерминированная** — одинаковые входные данные всегда дают одинаковый результат

## Алгоритмы

### Расстояние Левенштейна

Подсчитывает минимальное количество операций редактирования (вставка, удаление, замена) для преобразования одной строки в другую.

**Пример:** "привет" → "привит" требует 1 операцию (замена 'е' на 'и')
**Сходство:** 1 - (1/6) = 0.83 (83%)

### Сходство Джаро

Основано на количестве и порядке совпадающих символов. Символ считается совпадающим, если он одинаковый и находится в пределах определённого расстояния.

**Формула:** (m/|s₁| + m/|s₂| + (m-t)/m) / 3
- m = совпадающие символы
- t = транспозиции / 2

### Джаро-Винклер

Добавляет бонус за префикс к сходству Джаро для строк, которые совпадают с начала. Полезно для имён, где префикс обычно более значим.

**Формула:** Jaro + (длина_префикса × p × (1 - Jaro))
- p = коэффициент масштабирования (обычно 0.1)

### Расстояние Хэмминга

Простое сравнение по позициям. Требует строки одинаковой длины.

**Пример:** "привет" vs "привит" → 1 различающаяся позиция
**Сходство:** 1 - (1/6) = 0.83 (83%)

## Пример

**Эталон:** "привет"

**Ответ AI:** "привет"

**Скор:** идентичны = **1.00 (100%)**

---

**Различие в один символ:**

**Ответ AI:** "привит"

**Левенштейн:** 0.83 (83%)
**Джаро-Винклер:** 0.90 (90%) — бонус за префикс "прив"

---

**Совершенно разные:**

**Ответ AI:** "пока"

**Левенштейн:** 0.17 (17%)
**Джаро:** 0.47 (47%)

## Интерпретация скора

|  Скор   |          Значение          |
|---------|----------------------------|
| 90-100% | Почти идентичные строки    |
| 70-90%  | Очень похожи (мало правок) |
| 50-70%  | Некоторое сходство         |
| 30-50%  | Слабое сходство            |
| 0-30%   | Очень разные строки        |

## Важные замечания

- **Не семантическая**: "счастливый" и "радостный" получат скор 0 несмотря на одинаковый смысл
- **Чувствительность к регистру**: По умолчанию без учёта регистра; можно настроить
- **Джаро-Винклер для имён**: Лучший выбор для сравнения имён людей/мест
- **Левенштейн для общего использования**: Наиболее универсальный алгоритм

## Конфигурация

|    Параметр     |   Тип   | По умолчанию |                      Описание                      |
|-----------------|---------|--------------|----------------------------------------------------|
| distanceMeasure | Enum    | JARO_WINKLER | Алгоритм: LEVENSHTEIN, HAMMING, JARO, JARO_WINKLER |
| caseSensitive   | Boolean | false        | Учитывать ли регистр при сравнении                 |

## Ссылки

- [Расстояние Левенштейна](https://ru.wikipedia.org/wiki/Расстояние_Левенштейна)
- [Джаро-Винклер](https://en.wikipedia.org/wiki/Jaro%E2%80%93Winkler_distance)

